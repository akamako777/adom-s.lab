# 🏫 教員向け・万能フォーム集計システム (GAS Student Portfolio Manager)

**Googleフォームの回答を「個人別カルテ」に自動変換＆SOSワードを即座に検知。** 日々の健康観察、授業振り返り、教育相談アンケートの集計業務を劇的に効率化するGoogle Apps Script (GAS) です。

![License](https://img.shields.io/badge/license-MIT-blue.svg) ![GAS](https://img.shields.io/badge/Built%20with-Google%20Apps%20Script-green.svg)

## 🚀 特徴 (Features)

毎回のアンケート結果をコピペする必要はありません。このスクリプトは以下の処理を全自動で行います。

* **📊 個人別シートの自動作成:** 生徒一人ひとりの専用シート（カルテ）を自動生成し、回答を時系列で蓄積します。
* **📈 成長の可視化:** 点数や数値を入力すると、自動でグラフ化。生徒の変容が一目でわかります。
* **🚨 SOSアラート機能:** 「死にたい」「眠れない」などのSOSキーワードが含まれる回答を自動検出し、セルの色を変えて警告します（キーワードはカスタマイズ可能）。
* **📂 プライバシー重視:** 処理はすべて**あなたのGoogleアカウント内**で完結します。外部サーバーに生徒の個人情報が送信されることはありません。

## 🛠️ 導入方法 (Installation)

### 手順 1: Googleフォームとスプレッドシートの準備
1.  Googleフォームを作成します（質問に「出席番号」や「氏名」を含めてください）。
2.  回答先として「スプレッドシート」を作成・紐づけします。

### 手順 2: スクリプトの導入
1.  スプレッドシートを開き、メニューの `拡張機能` > `Apps Script` をクリック。
2.  エディタが開くので、既存のコードを消し、本リポジトリの `code.gs` の内容をすべて貼り付けます。
3.  `Ctrl + S` (Macは `Cmd + S`) で保存します。プロジェクト名は「集計システム」などでOK。

### 手順 3: 初回セットアップ
1.  スプレッドシートに戻り、ブラウザを**再読み込み（F5）**します。
2.  数秒待つと、メニューバーの右側に **「★集計システム★」** という新しいメニューが現れます。
3.  `★集計システム★` > `初期設定（トリガー設置）` をクリックします。
    * *※初回のみ「承認」画面が出ます。自分のアカウントを選択し、「詳細」>「安全ではないページに移動」から許可を与えてください（自作スクリプトのため表示される警告です）。*

## 📖 使い方 (Usage)

1.  **名簿の準備:**
    * 「設定」シート（自動生成されます）または「基本情報」シートに、生徒のID（出席番号）と名前を入力します。
2.  **個人シートの一括作成:**
    * メニューの `個人シート作成` > `全員分作成` を実行すると、人数分のシートが一瞬で作られます。
3.  **あとは待つだけ:**
    * 生徒がフォームから回答すると、自動的にその生徒の個人シートにデータが追記されます。
    * SOSワードが含まれている場合、セルが赤や黄色にハイライトされます。

## ⚙️ カスタマイズ (Configuration)

コード内の以下の部分を書き換えることで、SOS検知ワードを自由に変更できます。

```javascript
// コード内の highlightSOS 関数付近
const sosKeywords = ['辛い', '助けて', '眠れない', 'いじめ']; // 検知したい単語を追加

🛡️ ライセンス & 免責事項
This project is licensed under the MIT License - see the LICENSE file for details.

Privacy First: このツールは、使用者のGoogle Drive内でのみ動作します。開発者（Adom's Lab）がデータを収集することはありません。

Disclaimer: 本ツール使用によるデータの損失や損害について、開発者は責任を負いません。重要なデータは必ずバックアップを取ってください。

Developed by Adom's Lab Technology for Local Community & Education.
